<?xml version="1.0" encoding="UTF-8"?>
<gretl-functions>
<gretl-function-package name="KaoTest" ID="1362609158" needs-panel-data="true" minver="1.9.4">
<author>Uriel Rodriguez Ramirez</author>
<version>2.0</version>
<date>2013-03-06</date>
<description>Cointegration Test of Panel Data</description>
<help>
--------------------------------------------------------------------------
Cointegration Of Panel Data
Uriel Rodr√≠guez Ramirez, Universidad de Guanajuato.
urieleconometria@hotmail.com 
--------------------------------------------------------------------------

Kao (1999) proposed DF and ADF-type unit root tests for reiduals as a test for the null of no cointegration. The DF-type tests can be calculated from the fixed effects residuals.

ADF-type converge ta a standar normal distribution N(0,1) by sequential limit theory.

Inputs:
1. Dependent variable
2. Independent variables matrix 
3. Estimation method

Ouput:
1. Cointegration test
</help>
<gretl-function name="KaoTest" type="scalar">
 <params count="3">
  <param name="y" type="series">
<description>dependent variable</description>
  </param>
  <param name="X" type="list">
<description>regressors</description>
  </param>
  <param name="CV" type="int" min="1" max="2">
<description>1 = Fixed Effects, 2 = Random Effects</description>
  </param>
 </params>
<code>
if CV==1
  panel y 0 X --fixed-effects --quiet
  #number of obs
  scalar nT = $T
  #cross-sectional units
  scalar n = max($unit)
  #time-series length
  scalar T = $pd
  series e=$uhat
  ols e e(-1)
  p=$coeff
  DF=(sqrt(n)*T*(p-1)+3*sqrt(n))/(sqrt(10.2))
  scalar pv=pvalue(z, DF)
  printf &quot;==============================================================\n&quot;
  printf &quot;Cointegration Test\n&quot;
  printf &quot;==============================================================\n&quot;
  printf &quot;Null Hypothesis: Not Cointegration\n&quot;
  printf &quot;Test Statistic = %g\n&quot;,DF
  printf &quot;p-value = %g\n&quot;,pv
  printf &quot;--------------------------------------------------------------\n\n&quot;
  
else # CV==2
  panel y 0 X --random-effects --quiet
  #number of obs
  scalar nT = $T
  #cross-sectional units
  scalar n = max($unit)
  #time-series length
  scalar T = $pd
  series e=$uhat
  ols e e(-1)
  p=$coeff
  DF=(sqrt(n)*T*(p-1)+3*sqrt(n))/(sqrt(10.2))
  scalar pv=pvalue(z, DF)
  printf &quot;==============================================================\n&quot;
  printf &quot;Cointegration Test\n&quot;
  printf &quot;==============================================================\n&quot;
  printf &quot;Null Hypothesis: Not Cointegration\n&quot;
  printf &quot;Test Statistic = %g\n&quot;,DF
  printf &quot;p-value = %g\n&quot;,pv
  printf &quot;--------------------------------------------------------------\n\n&quot;
endif

return pv
</code>
</gretl-function>
<sample-script>
include KaoTest.gfn
open penngrow.gdt
series h=Y
list j=X
KaoTest(h, j, 1)
</sample-script>
</gretl-function-package>
</gretl-functions>

