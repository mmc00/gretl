# Replication of Wooldridge, J. M. (2005) 
# "A simple solution to the initial condition problem in dynamic, 
# nonlinear panel data models with unobserved heterogeneity"
# Journal of Applied Econometrics, 20:39-54

set echo off
set messages off

include DPB.gfn

open http://gretl.cvs.sourceforge.net/viewvc/gretl/gretl/share/data/misc/union_wooldridge.gdt

list TIME = dummify(year)
TIME -= Dyear_2
list MARR = marr8*

# -------- Chamberlain estimator (1980)------
# alpha_i  = MARR*psi + eta_i + u_it
# ------------------------------------------

# ---------Table I, p. 52------------------


list X = const union_1 union80 married MARR TIME

probit union  X --random-effects --quadpoints=12
probit union X educ black --random-effects --quadpoints=12




#---- DP MODEL: Heckman (1981b) ----------

list X1 = const married MARR TIME
list Z1 = const married 

b1 = DPB_setup("DP",union,X1,Z1)
DPB_setoption(&b1, "nrep", 12)
DPB_estimate(&b1)
DPB_printout(&b1)

list X2 = const married MARR TIME educ black
list Z2 = const married educ black

b2 = DPB_setup("DP",union,X2,Z2)
DPB_setoption(&b2, "nrep", 12)
DPB_estimate(&b2)
DPB_printout(&b2)



# --------- Mundlak (1978) -----------------------------
# alpha_i = mean(married)*psi + eta_i + u_it
# -----------------------------------------------------

m_marr = pmean(married)


# ----- Initial conditions as in Wooldridge (2005)-----

list X = const union_1 union80 married m_marr TIME
probit union  X --random-effects --quadpoints=12


# ----- Initial conditions as in Heckman (1981b)-----

list X = const married m_marr TIME
list Z = const married 

b = DPB_setup("DP",union,X,Z)
DPB_setoption(&b, "nrep", 12)
DPB_estimate(&b)
DPB_printout(&b)





