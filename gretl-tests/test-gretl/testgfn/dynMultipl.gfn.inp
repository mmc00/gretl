include ./dynMultipl.gfn
clear
set echo off
set messages off

#********************************************
# EXAMPLE I: ECM with G2S model reduction	*
#********************************************
open denmark.gdt --quiet
scalar h = 40
scalar p = 8
scalar q = 8
scalar alpha = 0.05				# if alpha=0 no G2S model reduction
series D801 = (obs=1980:1)
list DET = const D801			# add a dummy for illustration
list ylist = LRM
list Dylist = diff(ylist)
list xlist = LRY IBO
list Dxlist = diff(xlist)
#list xlist = null				# IF activated a stationary ARDL is estimated

#	Run the regression via fnct OLS which calls dynmulti	#
BOUT = OLS(DET,ylist,xlist,Dxlist,p,q,alpha)

# Calculate dynamic multipliers for each exogeneous I(1) regressor 
matrix DM = zeros(h,nelem(Dxlist))				# Effect of LRY ~ IBO on LRM
loop i=1..nelem(Dxlist) -q
    DM[,i] = dynmulti(BOUT.rho, BOUT.b[i], BOUT.varphi, BOUT.vpi[,i], h)
endloop
string vname = strsub(varname(Dxlist),","," ")
colnames(DM,"@vname")
gnuplot 1 2 --with-lines --time-series --matrix=DM --output=display



#************************************************************************************************************
# EXAMPLE II: REPLICATES OKUN'S LAW ESTIMATES FOR THE US (Symmetric long-run, asymmetric short-run dynamics)*
#************************************************************************************************************
matrix a = -0.06
matrix b = { -0.55 }#; -1.62}
scalar k = 2						# Number of I(0) regressors
matrix varphi = ( -0.19 ~ zeros(1,9) ~ 0.11 ~ zeros(1,6) )'
matrix vpi = ( -8.42 ~ 0 ~ -4.82 ~ zeros(1,15) ~ -8.24 ~ zeros(1,3) ~ -9.74 ~ zeros(1,13) )'
vpi = mshape(vpi,18,k)

#Effects of X+ ~ X- on Y
matrix DM = zeros(h,k)
loop i=1..k -q
    DM[,i] = dynmulti(a, b[1], varphi, vpi[,i], h)
endloop
DM[,2] = -1.*DM[,2]
gnuplot 1 2 --with-lines --time-series --matrix=DM --output=display --single-yaxis