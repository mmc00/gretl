<?xml version="1.0" encoding="UTF-8"?>
<gretl-functions>
<gretl-function-package name="seasfSTB" ID="1403694642" needs-qm-data="true" minver="1.8.4">
<author>Ignacio Diaz-Emparanza</author>
<version>1.0</version>
<date>2014-06-25</date>
<description>Seasonal filters</description>
<label>Seasonal filters</label>
<menu-attachment>MAINWIN/Variable/Filter</menu-attachment>
<help>
This package creates a list of seasonal filters for a given series. Each filter is designed for eliminating one of the seasonal unit roots. (Se Hylleberg, Engle, Granger and Yoo, 1990, Journal of Econometrics (HEGY)). The algorithm used here comes from the general formulas in Smith, R.J., Taylor, A.M.R., del Barrio Castro, T., 2009. Regression-based seasonal unit roots. Econometric Theory 25, 527â€“560.

The function depends on two parameters 
y: variable to transform,
k: is a boolean (0/1) if 1 all the series are contemporaneous and only one series is generated for the complex conjugated roots, if 0 two lags of the series are generated and all of them are lagged one period (as in the HEGY equation)
</help>
<gretl-function name="seasfSTB" type="list">
 <params count="2">
  <param name="y" type="series" const="true"/>
  <param name="only" type="bool" default="0"/>
 </params>
<code>string yn=argname(y)
scalar s_asterisk = ($pd % 2==0) ? ($pd/2)-1 : floor($pd/2)
matrix b0 = ones($pd,1)
# all frequencies except zero
series @yn0 = (obs&gt;=$pd) ? filter(y,b0) : NA
list fil = (only) ? @yn0 : @yn0(-1)
loop j=1..s_asterisk --quiet
  scalar w = 2*pi*j/$pd
  matrix frq = seq(1,$pd) * w
  series @yna$j=(obs&gt;=$pd) ? -filter(y,cos(frq)) : NA
  series @ynb$j=(obs&gt;=$pd) ?  filter(y,sin(frq)) : NA
  fil += (only) ? @yna$j(0) : @yna$j(-1) @ynb$j(-1)
endloop
# all frequencies except pi
if ($pd % 2==0)
  matrix b2 = cos(pi * seq(1,$pd))
  series @ynpi = (obs&gt;=$pd) ? filter(y,b2) : NA
  list fil += (only) ? @ynpi : @ynpi(-1)
endif
return fil
</code>
</gretl-function>
<sample-script>
include seasfSTB.gfn

open data9-3.gdt
list reskwh_filters = seasfSTB(reskwh, 0)
print reskwh_filters --byobs
</sample-script>
</gretl-function-package>
</gretl-functions>

