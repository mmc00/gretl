gretl version 2016b-git
Copyright Ramu Ramanathan, Allin Cottrell and Riccardo "Jack" Lucchetti
This is free software with ABSOLUTELY NO WARRANTY
Current session: 2016-04-21 00:54
? run sjlim.inp
 /home/cottrell/stats/test-gretl/system/sjlim.inp
? open sjlim.gdt

Read datafile /home/cottrell/stats/test-gretl/system/sjlim.gdt
periodicity: 12, maxobs: 187
observations range: 1995:02 to 2010:08

Listing 13 variables:
  0) const    1) sw1      2) sw2      3) sw3      4) sw4    
  5) dq1      6) dq2      7) dq3      8) dq4      9) dp1    
 10) dp2     11) dp3     12) dp4    

? genr DivisiaQ = sw1*dq1 + sw2*dq2 + sw3*dq3 + sw4*dq4
Generated series DivisiaQ (ID 13)
? genr wdq1 = sw1*dq1
Generated series wdq1 (ID 14)
? genr wdq2 = sw2*dq2
Generated series wdq2 (ID 15)
? genr wdq3 = sw1*dq3
Generated series wdq3 (ID 16)
? genr wdq4 = sw2*dq4
Generated series wdq4 (ID 17)
? genr ddp1=dp1-dp4
Generated series ddp1 (ID 18)
? genr ddp2=dp2-dp4
Generated series ddp2 (ID 19)
? genr ddp3=dp3-dp4
Generated series ddp3 (ID 20)
? system name="Rotterdam"
? equation wdq1 DivisiaQ ddp1 ddp2 ddp3
? equation wdq2 DivisiaQ ddp1 ddp2 ddp3
? equation wdq3 DivisiaQ ddp1 ddp2 ddp3
? end system
# Unrestricted estimation
? estimate "Rotterdam" method=sur

Equation system, Rotterdam
Estimator: Seemingly Unrelated Regressions

Equation 1: SUR, using observations 1995:02-2010:07 (T = 186)
Dependent variable: wdq1

             coefficient   std. error   t-ratio   p-value 
  --------------------------------------------------------
  DivisiaQ    0.508077     0.0213022    23.85     6.63e-58 ***
  ddp1       -0.575472     0.0730790    -7.875    2.98e-13 ***
  ddp2       -0.0857695    0.0544893    -1.574    0.1172  
  ddp3        0.839723     0.0467801    17.95     3.94e-42 ***

Mean dependent var   0.003633   S.D. dependent var   0.109815
Sum squared resid    0.332517   S.E. of regression   0.042282

Equation 2: SUR, using observations 1995:02-2010:07 (T = 186)
Dependent variable: wdq2

             coefficient   std. error   t-ratio   p-value 
  --------------------------------------------------------
  DivisiaQ    0.0391081    0.00314330   12.44     4.11e-26 ***
  ddp1        0.0345350    0.0107833     3.203    0.0016   ***
  ddp2       -0.00338201   0.00804028   -0.4206   0.6745  
  ddp3       -0.0392455    0.00690275   -5.685    5.11e-08 ***

Mean dependent var  -0.000272   S.D. dependent var   0.009755
Sum squared resid    0.007240   S.E. of regression   0.006239

Equation 3: SUR, using observations 1995:02-2010:07 (T = 186)
Dependent variable: wdq3

             coefficient   std. error   t-ratio   p-value 
  --------------------------------------------------------
  DivisiaQ     0.607355    0.0581564     10.44    2.65e-20 ***
  ddp1         2.01822     0.199510      10.12    2.28e-19 ***
  ddp2         0.330620    0.148759       2.223   0.0275   **
  ddp3        -2.90646     0.127713     -22.76    4.01e-55 ***

Mean dependent var  -0.007292   S.D. dependent var   0.272372
Sum squared resid    2.478332   S.E. of regression   0.115431

Cross-equation VCV for residuals
(correlations above the diagonal)

    0.0017877     (-0.398)     (-0.893)
  -0.00010486   3.8924e-05      (0.236)
   -0.0043595   0.00017024     0.013324

log determinant = -22.6561
Breusch-Pagan test for diagonal covariance matrix:
  Chi-square(3) = 188.19 [0.0000]

? restrict "Rotterdam"
? b[1,3] - b[2,2] = 0
? b[1,4] - b[3,2] = 0
? b[2,4] - b[3,3] = 0
? end restrict
Restriction set
 1: b[1,3] - b[2,2] = 0
 2: b[1,4] - b[3,2] = 0
 3: b[2,4] - b[3,3] = 0
# Restricted estimation, not iterated
? estimate "Rotterdam" method=sur

Equation system, Rotterdam
Estimator: Seemingly Unrelated Regressions

Equation 1: SUR, using observations 1995:02-2010:07 (T = 186)
Dependent variable: wdq1

             coefficient   std. error   t-ratio   p-value 
  --------------------------------------------------------
  DivisiaQ    0.542401     0.0260822    20.80     5.75e-50 ***
  ddp1       -0.437471     0.0624017    -7.011    4.48e-11 ***
  ddp2       -0.0854976    0.0228841    -3.736    0.0002   ***
  ddp3        0.806227     0.0573782    14.05     7.52e-31 ***

Mean dependent var   0.003633   S.D. dependent var   0.109815
Sum squared resid    0.351764   S.E. of regression   0.043488

Equation 2: SUR, using observations 1995:02-2010:07 (T = 186)
Dependent variable: wdq2

             coefficient   std. error   t-ratio   p-value
  -------------------------------------------------------
  DivisiaQ    0.0238498    0.0110282     2.163    0.0319  **
  ddp1       -0.0854976    0.0228841    -3.736    0.0002  ***
  ddp2       -0.0406587    0.0149418    -2.721    0.0071  ***
  ddp3        0.0775854    0.0200570     3.868    0.0002  ***

Mean dependent var  -0.000272   S.D. dependent var   0.009755
Sum squared resid    0.019748   S.E. of regression   0.010304

Equation 3: SUR, using observations 1995:02-2010:07 (T = 186)
Dependent variable: wdq3

             coefficient   std. error   t-ratio   p-value 
  --------------------------------------------------------
  DivisiaQ    0.404677     0.0569738      7.103   2.66e-11 ***
  ddp1        0.806227     0.0573782     14.05    7.52e-31 ***
  ddp2        0.0775854    0.0200570      3.868   0.0002   ***
  ddp3       -2.01885      0.0899145    -22.45    2.46e-54 ***

Mean dependent var  -0.007292   S.D. dependent var   0.272372
Sum squared resid    3.481835   S.E. of regression   0.136819

Cross-equation VCV for residuals
(correlations above the diagonal)

    0.0018912     (-0.316)     (-0.825)
  -0.00014179   0.00010617      (0.519)
   -0.0049092   0.00073226     0.018720

log determinant = -20.9108
Breusch-Pagan test for diagonal covariance matrix:
  Chi-square(3) = 195.421 [0.0000]

F test for the specified restrictions:
  F(3,546) = 41.7214 [0.0000]

# Restricted estimation, iterated
? estimate "Rotterdam" method=sur --iterate

Equation system, Rotterdam
Estimator: iterated Seemingly Unrelated Regressions

Convergence achieved after 21 iterations
Log-likelihood = 1267.26

Equation 1: SUR, using observations 1995:02-2010:07 (T = 186)
Dependent variable: wdq1

             coefficient   std. error   t-ratio   p-value 
  --------------------------------------------------------
  DivisiaQ    0.593643     0.0236593    25.09     5.54e-61 ***
  ddp1       -0.111757     0.0383627    -2.913    0.0040   ***
  ddp2        0.0180003    0.0104685     1.719    0.0872   *
  ddp3        0.519937     0.0422873    12.30     1.11e-25 ***

Mean dependent var   0.003633   S.D. dependent var   0.109815
Sum squared resid    0.487056   S.E. of regression   0.051172

Equation 2: SUR, using observations 1995:02-2010:07 (T = 186)
Dependent variable: wdq2

             coefficient   std. error   t-ratio   p-value 
  --------------------------------------------------------
  DivisiaQ    0.0360507    0.00313027   11.52     2.10e-23 ***
  ddp1        0.0180003    0.0104685     1.719    0.0872   *
  ddp2       -0.00701971   0.00767120   -0.9151   0.3614  
  ddp3       -0.0279293    0.00667307   -4.185    4.43e-05 ***

Mean dependent var  -0.000272   S.D. dependent var   0.009755
Sum squared resid    0.007436   S.E. of regression   0.006323

Equation 3: SUR, using observations 1995:02-2010:07 (T = 186)
Dependent variable: wdq3

             coefficient   std. error   t-ratio   p-value 
  --------------------------------------------------------
  DivisiaQ    0.333270     0.0678116      4.915   1.98e-06 ***
  ddp1        0.519937     0.0422873     12.30    1.11e-25 ***
  ddp2       -0.0279293    0.00667307    -4.185   4.43e-05 ***
  ddp3       -1.84101      0.107482     -17.13    8.51e-40 ***

Mean dependent var  -0.007292   S.D. dependent var   0.272372
Sum squared resid    4.116949   S.E. of regression   0.148775

Cross-equation VCV for residuals
(correlations above the diagonal)

    0.0026186     (-0.416)     (-0.928)
  -0.00013443   3.9977e-05      (0.283)
   -0.0070637   0.00026647     0.022134

log determinant = -22.14

LR test for the specified restrictions:
  Restricted log-likelihood = 1267.26
  Unrestricted log-likelihood = 1315.25
  Chi-square(3) = 95.9903 [0.0000]

? foreign language=R --send-data
?    wdq1 <- gretldata[,"wdq1"]
?    wdq2 <- gretldata[,"wdq2"]
?    wdq3 <- gretldata[,"wdq3"]
?    wdq4 <- gretldata[,"wdq4"]
?    ddp1 <- gretldata[,"ddp1"]
?    ddp2 <- gretldata[,"ddp2"]
?    ddp3 <- gretldata[,"ddp3"]
?    DivisiaQ <- gretldata[,"DivisiaQ"]
?    library(systemfit)
?    e1 <- wdq1 ~ 0 + DivisiaQ + ddp1 + ddp2 + ddp3
?    e2 <- wdq2 ~ 0 + DivisiaQ + ddp1 + ddp2 + ddp3
?    e3 <- wdq3 ~ 0 + DivisiaQ + ddp1 + ddp2 + ddp3
?    system <- list(e1, e2, e3)
?    # Unrestricted estimation
?    fit1 <- systemfit(system, method="SUR")
?    print(summary(fit1))
?    R <- matrix(0,3,12)
?    q <- matrix(0,3,1)
?    R[1,3] <-  1
?    R[1,6] <- -1
?    R[2,4] <- 1
?    R[2,10] <- -1
?    R[3,8] <- 1
?    R[3,11] <- -1
?    # Restricted estimation, not iterated
?    fit1r <- systemfit(system, method="SUR", restrict.matrix=R,
?       restrict.rhs=q, maxiter=1)
?    print(summary(fit1r))
?    # Restricted estimation, iterated
?    fit2 <- systemfit(system, method="SUR", restrict.matrix=R,
?       restrict.rhs=q, maxiter=80)
?    print(summary(fit2))
?    lrtest(fit2, fit1)
? end foreign
R exited with status 256
stderr:
Error in library(systemfit) : there is no package called 'systemfit'
Calls: source -> withVisible -> eval -> eval -> library
Execution halted


